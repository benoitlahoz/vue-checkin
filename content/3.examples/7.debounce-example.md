# Debounce Plugin Example - Search with Debouncing

Demonstration of the debouncing plugin to optimize high-frequency events.

## Interactive Demo

::debounce-example
::

## Overview

This example highlights:
- **Event debouncing** for check-in/check-out operations
- **Real-time search** with optimized performance
- **Automatic batching** of notifications
- **Manual control** with flush/cancel
- **Tracking pending operations**

## Architecture

### Debounce Plugin

The `createDebouncePlugin` plugin groups event notifications to avoid unnecessary processing during rapid operations.

```typescript
import { createDebouncePlugin } from 'vue-checkin';

const debouncePlugin = createDebouncePlugin({
  checkInDelay: 500,    // Delay for check-in events
  checkOutDelay: 300,   // Delay for check-out events
  maxWait: 2000,        // Maximum delay before forced execution
});
```

### Main Component: DebounceExample.vue

The component manages a real-time search with event debouncing.

```vue
<script setup lang="ts">
import { useCheckIn } from 'vue-checkin';
import { createDebouncePlugin, createLoggerPlugin } from 'vue-checkin/plugins';

interface SearchResult {
  title: string;
  description: string;
  category: string;
}

// Create the debounce plugin
const debouncePlugin = createDebouncePlugin<SearchResult>({
  checkInDelay: 500,
  checkOutDelay: 300,
  maxWait: 2000,
});

// Create a desk with the plugins
const { createDesk } = useCheckIn<SearchResult>();
const { desk } = createDesk('search-desk', {
  plugins: [debouncePlugin, loggerPlugin],
});

// Listen to debounced events
desk.onDebouncedCheckIn?.((id, data) => {
  console.log('Debounced event:', data.title);
});
</script>
```

### Result Component: SearchResultItem.vue

Each search result automatically registers with the desk.

```vue
<script setup lang="ts">
import { checkInToDesk } from 'vue-checkin';

const props = defineProps<{
  id: string;
  title: string;
  description: string;
  category: string;
}>();

// Auto check-in
const { checkOut, updateSelf } = checkInToDesk('search-desk', {
  id: props.id,
  data: {
    title: props.title,
    description: props.description,
    category: props.category,
  },
});
</script>
```

## How Debouncing Works

Debouncing is a technique that delays the execution of a function until a certain time has elapsed since the last call.

**Without debounce:**
- Type: "v" → Event
- Type: "vu" → Event  
- Type: "vue" → Event
- Result: 3 events

**With debounce (300ms):**
- Type: "v" → Wait...
- Type: "vu" → Wait...
- Type: "vue" → Wait... → Event after 300ms
- Result: 1 event

### Plugin Configuration

```typescript
createDebouncePlugin({
  // Delay before triggering check-in event
  checkInDelay: 500,
  
  // Delay before triggering check-out event
  checkOutDelay: 300,
  
  // Maximum wait time before forced execution
  maxWait: 2000,
})
```

### Available Methods

The plugin adds several methods to the desk:

```typescript
// Force immediate execution of pending events
desk.flushDebounce();

// Cancel all pending events
desk.cancelDebounce();

// Subscribe to debounced events
desk.onDebouncedCheckIn((id, data) => {
  console.log('Debounced check-in:', id);
});
```

### Computed Properties

```typescript
// Number of pending check-in events
const pending = desk.pendingCheckInsCount;

// Check if there are pending operations
const hasPending = desk.hasPendingDebounce;
```

## Use Cases

### 1. Real-Time Search

Avoid triggering an API search on every keystroke:

```vue
<script setup>
const searchQuery = ref('');

watch(searchQuery, (query) => {
  // Check-ins will be automatically debounced
  searchResults.value.forEach(result => {
    desk.checkIn(result.id, result);
  });
});
</script>
```

### 2. List Filtering

Optimize filtering of a large list.

### 3. Dynamic Forms

Delay validation while the user is typing.

## Benefits of Debouncing

### Performance

- ✅ **Reduces calculations** - Fewer events = less processing
- ✅ **Optimizes rendering** - Avoids unnecessary re-renders
- ✅ **Saves resources** - Fewer network/API calls

### User Experience

- ✅ **Smooth response** - No lag during typing
- ✅ **Relevant results** - Waits for user to finish
- ✅ **Fewer requests** - Reduces server load

## Best Practices

### 1. Choose the Right Delay

```typescript
// Search: 300-500ms (responsiveness vs performance)
checkInDelay: 400

// Validation: 500-1000ms (let the user finish)
checkInDelay: 800
```

### 2. Use maxWait

Always define a `maxWait` to avoid infinite waiting:

```typescript
createDebouncePlugin({
  checkInDelay: 500,
  maxWait: 2000, // Force after 2 seconds max
})
```

### 3. Proper Cleanup

Flush or cancel events before navigation:

```vue
<script setup>
onBeforeUnmount(() => {
  // Execute pending events
  desk.flushDebounce?.();
});
</script>
```

### 4. Combine with Other Plugins

Debounce works well with other plugins:

```typescript
const { desk } = createDesk('my-desk', {
  plugins: [
    createDebouncePlugin({ checkInDelay: 500 }),
    createLoggerPlugin({ verbose: true }),
  ],
});
```

## Resources

- [Complete Code Example](https://github.com/benoitlahoz/vue-checkin/tree/main/app/components/examples/debounce-example)
- [Lodash Debounce](https://lodash.com/docs/#debounce) - Reference implementation

## Next Steps

- Explore the [Validation Plugin](/examples/form-example) to combine debounce and validation
- Discover the [History Plugin](/examples/plugin-example) to track history
