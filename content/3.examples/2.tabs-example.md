# Tabs Example - Navigation par onglets

Exemple d'utilisation avec un système d'onglets et contexte partagé.

## Démo interactive

::tabs-example
::

## Vue d'ensemble

Cet exemple démontre :
- L'utilisation du **contexte** pour partager des données entre le desk et ses enfants
- La gestion d'un état actif partagé
- L'ajout et la suppression dynamique d'items
- La communication parent-enfant via événements

## Architecture

### Composant Parent : `TabsExample.vue`

Le composant parent crée un desk avec contexte pour partager l'onglet actif.

```vue
<script setup lang="ts">
import { useCheckIn } from '@/vue-checkin/composables/useCheckIn';
import TabItem from './TabItem.vue';
import { TABS_DESK_KEY } from './index';

interface TabItem {
  label: string;
  content: string;
  icon?: string;
}

// Context pour stocker l'onglet actif
const activeTabId = ref<string | number>('tab-1');

// Créer un desk avec contexte
const { createDesk } = useCheckIn<TabItem, { activeTab: Ref<string | number> }>();
const { desk } = createDesk(TABS_DESK_KEY, {
  context: { activeTab: activeTabId },
  debug: false,
});
</script>
```

### Composant Enfant : `TabItem.vue`

Chaque onglet s'enregistre et peut accéder au contexte partagé.

```vue
<script setup lang="ts">
import { useCheckIn } from '@/vue-checkin/composables/useCheckIn';
import { TABS_DESK_KEY } from './index';

const props = defineProps<{
  id: string | number;
  label: string;
  content: string;
  icon?: string;
  isActive: boolean;
  canClose: boolean;
}>();

// Auto check-in avec watch des données
useCheckIn<TabItem>().checkIn(TABS_DESK_KEY, {
  id: props.id,
  autoCheckIn: true,
  watchData: true,
  data: () => ({
    label: props.label,
    content: props.content,
    icon: props.icon,
  }),
});
</script>
```

### InjectionKey : `index.ts`

```typescript
import type { InjectionKey } from 'vue';
import type { CheckInDesk } from '@/vue-checkin/composables/useCheckIn';

interface TabData {
  label: string;
  icon: string;
}

export const TABS_DESK_KEY: InjectionKey<CheckInDesk<TabData>> = Symbol('tabsDesk');

export { default as TabsExample } from './TabsExample.vue';
export { default as TabItem } from './TabItem.vue';
```

## Fonctionnalités

### Contexte partagé

Le contexte permet de partager des données réactives entre le parent et tous les enfants :

```typescript
const { desk } = createDesk(TABS_DESK_KEY, {
  context: { activeTab: activeTabId },
});
```

Tous les composants enfants peuvent accéder à `activeTab` via le desk.

### Sélection d'onglet

```typescript
const selectTab = (id: string | number) => {
  activeTabId.value = id;
};
```

Le changement de contexte est réactif et tous les onglets sont notifiés.

### Ajout d'onglet

```typescript
const addTab = () => {
  const id = `tab-${Date.now()}`;
  tabsData.value.push({
    id,
    label: `Onglet ${tabsData.value.length + 1}`,
    content: 'Nouveau contenu',
    icon: 'i-heroicons-document',
  });
  activeTabId.value = id;
};
```

### Fermeture d'onglet

```typescript
const closeTab = (id: string | number) => {
  const index = tabsData.value.findIndex(t => t.id === id);
  if (index !== -1) {
    tabsData.value.splice(index, 1);
    // Sélectionner l'onglet précédent ou suivant
    if (activeTabId.value === id && tabsData.value.length > 0) {
      const newIndex = Math.max(0, index - 1);
      activeTabId.value = tabsData.value[newIndex].id;
    }
  }
};
```

## Concepts clés

::alert{type="info"}
**Contexte** : Permet de partager des données réactives entre le desk et tous ses enfants enregistrés.
::

::alert{type="info"}
**État actif** : Le contexte `activeTab` est partagé et réactif, tous les composants réagissent aux changements.
::

::alert{type="success"}
**Typage du contexte** : Le deuxième paramètre générique de `useCheckIn` définit le type du contexte.
::

## Utilisation

```vue
<template>
  <TabsExample />
</template>

<script setup lang="ts">
import { TabsExample } from '@/components/examples/tabs-example';
</script>
```

## Points d'attention

- Le contexte est typé avec le deuxième paramètre générique de `useCheckIn<T, TContext>`
- Les enfants ne reçoivent pas le contexte en prop, ils y accèdent via le desk
- Le contexte est réactif : tous les changements sont propagés automatiquement
- Utile pour partager un état global (onglet actif, mode, thème, etc.)
