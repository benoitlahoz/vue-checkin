# Basic Example - Todo List

Démonstration du système check-in/check-out avec une simple liste de tâches.

## Démo interactive

::basic-example
::

## Vue d'ensemble

Cet exemple illustre les concepts fondamentaux du système de check-in :
- Création d'un desk parent
- Enregistrement automatique des composants enfants
- Synchronisation réactive des données avec `watchData`
- Gestion du cycle de vie (check-in/check-out)

## Architecture

### Composant Parent : `BasicExample.vue`

Le composant parent crée le desk et gère l'état de la liste de tâches.

```vue
<script setup lang="ts">
import { useCheckIn } from '@/vue-checkin/composables/useCheckIn';
import TodoItem from './TodoItem.vue';
import { TODO_DESK_KEY } from './index';

interface TodoItem {
  label: string;
  done: boolean;
}

// Créer un desk pour gérer les items
const { createDesk } = useCheckIn<TodoItem>();
const { desk } = createDesk(TODO_DESK_KEY, {
  debug: true,
  onCheckIn: (id, data) => {
    console.log(`✅ Item ajouté: ${id}`, data);
  },
  onCheckOut: (id) => {
    console.log(`❌ Item retiré: ${id}`);
  },
});

// State pour gérer les todos
const todos = ref([]);
</script>
```

### Composant Enfant : `TodoItem.vue`

Chaque item s'enregistre automatiquement au desk et synchronise ses données.

```vue
<script setup lang="ts">
import { useCheckIn } from '@/vue-checkin/composables/useCheckIn';
import { TODO_DESK_KEY } from './index';

const props = defineProps<{
  id: string | number;
  label: string;
  done: boolean;
}>();

// Auto check-in avec watch des données
useCheckIn<TodoItem>().checkIn(TODO_DESK_KEY, {
  id: props.id,
  autoCheckIn: true,
  watchData: true,
  data: () => ({
    label: props.label,
    done: props.done,
  }),
});
</script>
```

### InjectionKey : `index.ts`

Définition de la clé d'injection typée pour une meilleure type-safety.

```typescript
import type { InjectionKey } from 'vue';
import type { CheckInDesk } from '@/vue-checkin/composables/useCheckIn';

interface TodoItem {
  label: string;
  done: boolean;
}

export const TODO_DESK_KEY: InjectionKey<CheckInDesk<TodoItem>> = Symbol('todoDesk');

export { default as BasicExample } from './BasicExample.vue';
export { default as TodoItem } from './TodoItem.vue';
```

## Fonctionnalités

### Ajouter une tâche

```typescript
const addItem = () => {
  const id = Date.now();
  todos.value.push({
    id,
    label: `Tâche ${id}`,
    done: false,
  });
};
```

Le composant `TodoItem` s'enregistrera automatiquement au desk grâce à `autoCheckIn: true`.

### Basculer l'état d'une tâche

```typescript
const toggleItem = (id: string | number) => {
  const todo = todos.value.find(t => t.id === id);
  if (todo) {
    todo.done = !todo.done;
  }
};
```

Les changements sont automatiquement synchronisés avec le desk grâce à `watchData: true`.

### Retirer une tâche

```typescript
const removeItem = (id: string | number) => {
  const index = todos.value.findIndex(t => t.id === id);
  if (index !== -1) {
    todos.value.splice(index, 1);
  }
};
```

Le composant se désenregistre automatiquement lorsqu'il est détruit.

## Concepts clés

::alert{type="info"}
**Auto Check-In** : Les composants enfants s'enregistrent automatiquement lors de leur montage grâce à `autoCheckIn: true`.
::

::alert{type="info"}
**Watch Data** : Les données sont synchronisées automatiquement avec le desk grâce à `watchData: true`.
::

::alert{type="info"}
**InjectionKey** : Utilisation de `Symbol` pour une injection typée et sécurisée.
::

## Utilisation

```vue
<template>
  <BasicExample />
</template>

<script setup lang="ts">
import { BasicExample } from '@/components/examples/basic-example';
</script>
```

## Points d'attention

- Le `desk` n'est pas passé en prop, il est injecté via `TODO_DESK_KEY`
- Les enfants gèrent leur propre enregistrement/désenregistrement
- La synchronisation est automatique grâce à `watchData`
- Chaque modification de prop déclenche une mise à jour dans le desk
