---
title: Shopping Cart 
description: E-commerce cart with context sharing and lifecycle hooks.
navigation:
  icon: i-heroicons-shopping-cart
seo:
  title: Shopping Cart - VueAirport
  description: Build a shopping cart with VueAirport featuring context sharing, lifecycle hooks, and automatic total calculation.
---

A complete e-commerce shopping cart demonstration:

1. **Context sharing** - Products data shared via desk context
2. **Lifecycle hooks** - Track product additions/removals
3. **Dynamic calculations** - Cart total updates automatically
4. **Quantity management** - Update quantities from context

::example-loader{:component="ShoppingCart"}
::

## Project Structure

```
shopping-cart/
├── index.ts              # Shared types and injection key
├── ShoppingCart.vue       # Parent cart component
└── ProductCard.vue       # Individual product card
```

## Shared Types (index.ts)

```typescript
import type { InjectionKey, Ref } from 'vue';
import type { DeskCore } from '#vue-airport/composables/useCheckIn';

export interface CartItem {
  name: string;
  price: number;
  quantity: number;
  imageUrl?: string;
}

export interface Product {
  id: string;
  name: string;
  price: number;
  quantity: number;
  imageUrl?: string;
}

export interface CartContext {
  products: Ref<Product[]>;
  updateQuantity: (id: string, quantity: number) => void;
}

export const CART_DESK_KEY: InjectionKey<DeskCore<CartItem> & CartContext> = Symbol('cartDesk');
```

## Parent Component (ShoppingCart.vue)

Creates the cart desk with context sharing:

```vue
<script setup lang="ts">
import { useCheckIn } from '#vue-airport/composables/useCheckIn';
import ProductCard from './ProductCard.vue';
import { type CartItem, type CartContext, CART_DESK_KEY } from '.';

// Function to update product quantity
const updateQuantity = (id: string, quantity: number) => {
  const product = products.value.find((p) => p.id === id);
  if (product) {
    product.quantity = Math.max(1, quantity);
  }
};

// Available products catalog
const products = ref([
  {
    id: 'product-1',
    name: 'Laptop Pro',
    price: 1299.99,
    quantity: 1,
    imageUrl: 'i-heroicons-computer-desktop',
  },
  // ... more products
]);

// Create a desk for the shopping cart with context
const { createDesk } = useCheckIn<CartItem, CartContext>();
const { desk } = createDesk(CART_DESK_KEY, {
  devTools: true,
  debug: false,
  context: {
    products,
    updateQuantity,
  },
  onCheckIn: (_id, data) => {
    console.log(`Product added to cart: ${data.name}`);
  },
  onCheckOut: (id) => {
    console.log(`Product removed from cart: ${id}`);
  },
});

// Computed properties for cart data
const cartItems = computed(() => desk.getAll());
const cartCount = computed(() => {
  return cartItems.value.reduce((total, item) => {
    return total + item.data.quantity;
  }, 0);
});
const cartTotal = computed(() => {
  return cartItems.value.reduce((total, item) => {
    return total + item.data.price * item.data.quantity;
  }, 0);
});
</script>

<template>
  <div>
    <div class="grid grid-cols-1 lg:grid-cols-[2fr_1fr] gap-8 mt-6">
      <div>
        <div class="grid grid-cols-[repeat(auto-fill,minmax(200px,1fr))] gap-4">
          <ProductCard
            v-for="product in products"
            :id="product.id"
            :key="product.id"
          />
        </div>
      </div>
      <!-- Cart UI... -->
    </div>
  </div>
</template>
```
## Child Component (ProductCard.vue)

Retrieves product data from desk context:

```vue
<script setup lang="ts">
import { useCheckIn } from '#vue-airport/composables/useCheckIn';
import { type CartItem, type CartContext, CART_DESK_KEY } from '.';

const props = defineProps<{
  id: string;
}>();

// Check in to the cart desk and get context
const { checkIn } = useCheckIn<CartItem, CartContext>();
const { desk } = checkIn(CART_DESK_KEY, {
  id: props.id,
  autoCheckIn: false,
  watchData: true,
  data: (desk) => {
    const product = desk.products.value.find((p) => p.id === props.id);
    return {
      name: product?.name ?? '',
      price: product?.price ?? 0,
      quantity: product?.quantity ?? 1,
      imageUrl: product?.imageUrl,
    };
  },
});

// Get product data from context
const productData = computed(() => {
  return desk?.products?.value.find((p) => p.id === props.id);
});

// Check if product is in the cart
const isInCart = computed(() => desk?.has(props.id) ?? false);

// Add product to cart
const addToCart = () => {
  if (!productData.value) return;

  if (desk?.has(props.id)) {
    const currentItem = desk.get(props.id);
    if (currentItem) {
      const newQty = currentItem.data.quantity + 1;
      desk.update(props.id, { quantity: newQty });
      desk.updateQuantity(props.id, newQty);
    }
  } else {
    desk?.checkIn(props.id, {
      name: productData.value.name,
      price: productData.value.price,
      quantity: productData.value.quantity,
      imageUrl: productData.value.imageUrl,
    });
  }
};

// Increment/decrement quantity
const increment = () => {
  if (!productData.value) return;
  const newQuantity = productData.value.quantity + 1;
  desk?.updateQuantity(props.id, newQuantity);
  
  if (desk?.has(props.id)) {
    desk.update(props.id, { quantity: newQuantity });
  }
};

const decrement = () => {
  if (!productData.value) return;
  const newQuantity = Math.max(1, productData.value.quantity - 1);
  desk?.updateQuantity(props.id, newQuantity);
  
  if (desk?.has(props.id)) {
    desk.update(props.id, { quantity: newQuantity });
  }
};
</script>

<template>
  <div class="border rounded-lg p-4 flex flex-col gap-3">
    <div class="flex justify-center items-center h-16 text-5xl">
      <UIcon :name="productData?.imageUrl || 'i-heroicons-cube'" />
    </div>

    <div class="flex flex-col gap-2 flex-1">
      <h4 class="text-base font-semibold m-0">{{ productData?.name }}</h4>
      <div class="text-xl font-bold">${{ productData?.price.toFixed(2) }}</div>
    </div>

    <div class="flex flex-col gap-2">
      <UButton v-if="!isInCart" size="sm" block @click="addToCart">
        Add to Cart
      </UButton>

      <div v-if="isInCart" class="flex items-center gap-2 justify-center">
        <UButton
          size="xs"
          icon="i-heroicons-minus"
          :disabled="(productData?.quantity ?? 1) <= 1"
          @click="decrement"
        />
        <span class="min-w-8 text-center font-semibold">{{ productData?.quantity }}</span>
        <UButton size="xs" icon="i-heroicons-plus" @click="increment" />
      </div>
    </div>
  </div>
</template>
```

## Key Concepts

### Context Sharing

The desk shares data through context, similar to the Tabs example:

```typescript
const { createDesk } = useCheckIn<CartItem, CartContext>();
const { desk } = createDesk(CART_DESK_KEY, {
  context: {
    products,
    updateQuantity,
  },
});
```

Child components access this context via the `data` function:

```typescript
const { checkIn } = useCheckIn<CartItem, CartContext>();
const { desk } = checkIn(CART_DESK_KEY, {
  data: (desk) => {
    const product = desk.products.value.find((p) => p.id === props.id);
    return {
      name: product?.name ?? '',
      price: product?.price ?? 0,
      quantity: product?.quantity ?? 1,
      imageUrl: product?.imageUrl,
    };
  },
});
```

### Lifecycle Hooks

Track cart operations with lifecycle hooks:

```typescript
createDesk(CART_DESK_KEY, {
  onCheckIn: (id, data) => {
    console.log(`Product added: ${data.name}`);
  },
  onCheckOut: (id) => {
    console.log(`Product removed: ${id}`);
  },
});
```

### Dynamic Calculations

Cart totals are computed from registry data:

```typescript
const cartCount = computed(() => {
  return cartItems.value.reduce((total, item) => {
    return total + item.data.quantity;
  }, 0);
});

const cartTotal = computed(() => {
  return cartItems.value.reduce((total, item) => {
    return total + item.data.price * item.data.quantity;
  }, 0);
});
```

### Quantity Management

Quantities are managed through the shared context:

```typescript
// Update quantity in context
const increment = () => {
  if (!productData.value) return;
  const newQuantity = productData.value.quantity + 1;
  desk?.updateQuantity(props.id, newQuantity);
  
  // Sync with cart if item is in it
  if (desk?.has(props.id)) {
    desk.update(props.id, { quantity: newQuantity });
  }
};
```

## How It Works

1. **Parent provides context** with products array and updateQuantity function
2. **Children retrieve data** from context via `data()` function with `watchData: true`
3. **No props needed** - only the product `id` is passed
4. **Quantity updates** sync between context and cart items
5. **Cart calculations** update automatically when items change
